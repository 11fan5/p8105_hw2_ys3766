---
title: "p8105_hw2_ys3766"
author: "Yifan Shi"
date: "2024-10-02"
output: github_document
---
```{r}
library(tidyverse)
library(readxl)
```

### Problem 1

Importing data, cleaning data, selecting variables
```{r}
transit = 
  read_csv(
    "data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
    col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11= "c")) %>% 
  janitor::clean_names() %>% 
  select(
    line, station_name, station_latitude, station_longitude, entry, exit_only, vending, entrance_type, ada,
    starts_with("route")
  ) %>% 
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
  
```

The resulting data set contains 1868 observations of 20 variables now. It has variables on NYC subway lines, stations, location of the station, entry and exit information, vending, ADA compliance information and routes.I cleaned the data by converting column types of route8-route11, cleaning the names of the variables, selecting relevant variables, and converting the entry variable to logical. I would say the dataset is not yet tidy, as the route variables is currently wide format. To further tidy the data set, I would convert the route variables from wide to long format, and create a new "route number" variable. 

Number of distinct stations
```{r}
transit %>% 
 distinct(line, station_name) %>% 
  nrow()
```

There are 465 distinct stations. 

ADA compliant stations
```{r}
transit %>% 
  filter(ada == TRUE) %>% 
  distinct(line, station_name) %>% 
  nrow()
```
There are 84 ADA compliant stations. 

Proportion of station entrances/exits without vending allow entrance
```{r}
transit %>% 
  filter(vending == "NO") %>% 
  pull(entry) %>% 
  mean()
```
37.7% of station entrances/exits without vending allow entrance

Reformat the data so that route number and route name are distinct variables
```{r}
transit<-transit %>% 
  pivot_longer(
    route1:route11,
    names_to = "route_number",
    values_to = "route"
  )
```

Distinct stations serve the A train, how many ADA compliant
```{r}
transit %>% 
  filter(route == "A") %>% 
  distinct(line, station_name) %>% 
  nrow()

transit %>% 
  filter(route == "A", ada == TRUE) %>% 
  distinct(line, station_name) %>% 
  nrow()
```

There are 60 distinct stations serving the A train, of which 17 are ADA compliant. 


### Problem 2

import and tidy the sheet Mr Trash Wheel
```{r}
mr_trash_wheel = 
  read_excel('data/202409 Trash Wheel Collection Data.xlsx', 
             sheet = 'Mr. Trash Wheel',
             range = cell_cols("A:N"),
             skip = 1,
             ) %>% 
  janitor::clean_names() %>% 
  filter(!is.na(dumpster)) %>% 
  mutate(sports_balls = as.integer(round(sports_balls)),
         year = as.numeric(year))
```

import and tidy the sheet Professor Trash Wheel
```{r}
prof_trash_wheel = 
  read_excel('data/202409 Trash Wheel Collection Data.xlsx', 
             sheet = 'Professor Trash Wheel',
             range = cell_cols("A:M"),
             skip = 1,
             ) %>% 
  janitor::clean_names() %>% 
  filter(!is.na(dumpster))
  
```

import and tidy the sheet Gwynnda Trash Wheel
```{r}
gwynnda_trash_wheel = 
  read_excel('data/202409 Trash Wheel Collection Data.xlsx', 
             sheet = 'Gwynnda Trash Wheel',
             range = cell_cols("A:L"),
             skip = 1,
             ) %>% 
  janitor::clean_names() %>% 
  filter(!is.na(dumpster)) 
```

Create an indicator variable for the sourse, then combine the 3 individual df to produce a single df
```{r}
mr_trash_wheel<- mr_trash_wheel %>% 
  mutate(source = "Mr. Trash Wheel")

prof_trash_wheel<- prof_trash_wheel %>% 
  mutate(source = "Professor Trash Wheel")

gwynnda_trash_wheel <- gwynnda_trash_wheel %>% 
  mutate(source = "Gwynnda Trash Wheel")

trash_wheel <- bind_rows(mr_trash_wheel, prof_trash_wheel, gwynnda_trash_wheel) %>% 
  relocate(source)
```

